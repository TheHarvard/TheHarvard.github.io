<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Thrustâ€‘Gravity Playground â€“ Six Synchronized Charts</title>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>

<style>
  body {font-family:Arial,sans-serif;margin:2rem;background:#f9f9f9;}
  h1 {margin-bottom:.5rem;}
  .group {margin-bottom:2.5rem;}
  .controls{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:.5rem;}
  .control{flex:1 1 220px;}
  label{display:block;font-weight:bold;margin-bottom:.3rem;}
  input[type=range]{width:100%;}
  canvas{background:#fff;border:1px solid #ccc;margin-top:1rem;}
  .unit-note{font-size:.85em;color:#555;margin-top:.2rem;}
</style>
</head>

<body>
<h1>ğŸš€ Thrustâ€‘Gravity Playground â€“ Six Synchronized Charts</h1>

<!-- ============================================================= -->
<!-- 1ï¸âƒ£ Physics helper functions (unchanged)                       -->
<!-- ============================================================= -->
<script>
const DEFAULT_constantAcceleration = 9.80665;
const DEFAULT_engineExhaustVelocity = 40000000;

function _assertPositiveNumber(value, name) {
  if (typeof value !== 'number' || value <= 0) {
    throw new RangeError(`${name} must be a positive number`);
  }
}

// Time from distance (seconds â†’ hours later)
function thrustGravity_timeFromDistance(distance, constantAcceleration = DEFAULT_constantAcceleration){
  _assertPositiveNumber(distance, "distance");
  _assertPositiveNumber(constantAcceleration, "constantAcceleration");
  return 2 * Math.sqrt(distance / constantAcceleration);
}

// Fuelâ€‘massâ€‘fraction from distance
function thrustGravity_fuelMassFractionFromDistance(distance,
                                                    constantAcceleration = DEFAULT_constantAcceleration,
                                                    engineExhaustVelocity = DEFAULT_engineExhaustVelocity){
  _assertPositiveNumber(distance, "distance");
  _assertPositiveNumber(constantAcceleration, "constantAcceleration");
  _assertPositiveNumber(engineExhaustVelocity, "engineExhaustVelocity");
  return 1 - Math.exp(-(2*Math.sqrt(constantAcceleration*distance)/engineExhaustVelocity));
}
</script>

<!-- ============================================================= -->
<!-- 2ï¸âƒ£ UI â€“ synchronize every slider set                         -->
<!-- ============================================================= -->
<script>
/* All sliders share the same underlying values.
   Whenever any slider changes we propagate the new value to every
   other slider of the same type (acceleration or exhaustâ€‘velocity)
   and then recompute the charts. */
function syncSliders(){
  const accelSliders = document.querySelectorAll('.accel');
  const veSliders    = document.querySelectorAll('.ve');
  const accelOuts   = document.querySelectorAll('.accelOut');
  const veOuts      = document.querySelectorAll('.veOut');

  function updateDisplays(a, ve){
    accelOuts.forEach(o=>o.textContent=
      `${a.toFixed(2)}â€¯mÂ·sâ»Â² (${(a/9.80665).toFixed(2)}â€¯g)`);
    veOuts.forEach(o=>o.textContent=
      `${ve.toLocaleString()}â€¯mÂ·sâ»Â¹ (${(ve/1000).toLocaleString()}â€¯kmÂ·sâ»Â¹)`);
  }

  // When any accel slider movesâ€¦
  accelSliders.forEach(sl=>sl.addEventListener('input',e=>{
    const a = Number(e.target.value);
    // copy value to all accel sliders
    accelSliders.forEach(s=>s.value=a);
    const ve = Number(veSliders[0].value); // current exhaust value
    updateDisplays(a,ve);
    recompute();
  }));

  // When any exhaustâ€‘velocity slider movesâ€¦
  veSliders.forEach(sl=>sl.addEventListener('input',e=>{
    const ve = Number(e.target.value);
    veSliders.forEach(s=>s.value=ve);
    const a = Number(accelSliders[0].value);
    updateDisplays(a,ve);
    recompute();
  }));

  // Initialise displays with the default values
  const initA  = Number(accelSliders[0].value);
  const initVe = Number(veSliders[0].value);
  updateDisplays(initA,initVe);
}
</script>

<!-- ============================================================= -->
<!-- 3ï¸âƒ£ DATA GENERATION                                            -->
<!-- ============================================================= -->
<script>
function generateAUSeries(minAU, maxAU){
  const AU_IN_METRES = 149598000000;
  const steps = 150;
  const distances = [];

  for(let i=0;i<=steps;i++){
    const t = i/steps;
    const au = Math.pow(10,
              Math.log10(minAU) + t * (Math.log10(maxAU)-Math.log10(minAU)));
    distances.push(au * AU_IN_METRES);
  }

  const a  = Number(document.querySelector('.accel').value);
  const ve = Number(document.querySelector('.ve').value);

  const time = distances.map(d=>({x:d/AU_IN_METRES,
                                y:thrustGravity_timeFromDistance(d,a)/3600}));
  const fuel = distances.map(d=>({x:d/AU_IN_METRES,
                                y:thrustGravity_fuelMassFractionFromDistance(d,a,ve)*100}));
  return {time,fuel};
}

// kmâ€‘range series (10â€¯km â†’ 1â€¯000â€¯000â€¯km)
function generateKmSeries(){
  const minM = 10_000;          // 10â€¯km in metres
  const maxM = 1_000_000_000;   // 1â€¯000â€¯000â€¯km in metres
  const steps = 150;
  const distances = [];

  for(let i=0;i<=steps;i++){
    const t = i/steps;
    const m = Math.pow(10,
            Math.log10(minM) + t * (Math.log10(maxM)-Math.log10(minM)));
    distances.push(m);
  }

  const a  = Number(document.querySelector('.accel').value);
  const ve = Number(document.querySelector('.ve').value);

  const time = distances.map(d=>({x:d/1000,   // km for the axis
                                y:thrustGravity_timeFromDistance(d,a)/3600}));
  const fuel = distances.map(d=>({x:d/1000,
                                y:thrustGravity_fuelMassFractionFromDistance(d,a,ve)*100}));
  return {time,fuel};
}
</script>

<!-- ============================================================= -->
<!-- 4ï¸âƒ£ CHART FACTORIES                                           -->
<!-- ============================================================= -->
<script>
let charts = {};

function createTimeChart(ctx, xLabel, xMin, xMax, isLog=true){
  return new Chart(ctx,{
    type:'line',
    data:{datasets:[{label:'Travel time',data:[],
                     borderColor:'#0066ff',
                     backgroundColor:'rgba(0,102,255,0.1)',
                     tension:0.2,pointRadius:0}]},
    options:{
      responsive:true,
      plugins:{tooltip:{callbacks:{label:ctx=>{
        const hrs = ctx.parsed.y;
        const days = hrs/24;
        const x = ctx.parsed.x;
        const km = isLog ? (x*149598000).toLocaleString()
                        : (x*1000).toLocaleString();
        const unit = isLog ? 'AU' : 'km';
        return `${unit}: ${x.toFixed(3)} (${km}â€¯km)\n${hrs.toFixed(2)}â€¯h (${days.toFixed(2)}â€¯d)`;
      }}}},
      scales:{
        x:{type:isLog?'logarithmic':'linear',
           title:{display:true,text:`Distance (${xLabel})`},
           min:xMin,max:xMax,
           ticks:{callback:v=>Number(v).toFixed(2)}},
        y:{title:{display:true,text:'Travel time (hours)'},
           ticks:{callback:v=>`${v.toFixed(0)}â€¯h (${(v/24).toFixed(1)}â€¯d)`}}
      }
    }
  });
}

function createFuelChart(ctx, xLabel, xMin, xMax, isLog=true){
  return new Chart(ctx,{
    type:'line',
    data:{datasets:[{label:'Fuel fraction',data:[],
                     borderColor:'#ff6600',
                     backgroundColor:'rgba(255,102,0,0.1)',
                     tension:0.2,pointRadius:0}]},
    options:{
      responsive:true,
      plugins:{tooltip:{callbacks:{label:ctx=>{
        const x = ctx.parsed.x;
        const km = isLog ? (x*149598000).toLocaleString()
                        : (x*1000).toLocaleString();
        const unit = isLog ? 'AU' : 'km';
        const perc = ctx.parsed.y;
        return `${unit}: ${x.toFixed(3)} (${km}â€¯km)\nFuel: ${perc.toFixed(2)}â€¯%`;
      }}}},
      scales:{
        x:{type:isLog?'logarithmic':'linear',
           title:{display:true,text:`Distance (${xLabel})`},
           min:xMin,max:xMax,
           ticks:{callback:v=>Number(v).toFixed(2)}},
        y:{title:{display:true,text:'Fuel fraction (%)'}}
        // yâ€‘axis autoâ€‘scales to the visible data
      }
    }
  });
}
</script>

<!-- ============================================================= -->
<!-- 5ï¸âƒ£ PAGE STRUCTURE â€“ ordered smallest â†’ largest               -->
<!-- ============================================================= -->

<!-- ---------- Travelâ€‘time charts (smallest first) ---------- -->
<div class="group">
  <!-- Slider set for the travelâ€‘time group -->
  <div class="controls">
    <div class="control">
      <label>Constant Acceleration (mÂ·sâ»Â²)</label>
      <input class="accel" type="range" min="0.1" max="50" step="0.1" value="9.80665">
      <output class="accelOut"></output>
      <div class="unit-note">1â€¯gâ€¯=â€¯9.80665â€¯mÂ·sâ»Â²</div>
    </div>
    <div class="control">
      <label>Engine Exhaust Velocity (mÂ·sâ»Â¹)</label>
      <input class="ve" type="range" min="1000000" max="80000000" step="500000" value="40000000">
      <output class="veOut"></output>
    </div>
  </div>

  <!-- 1ï¸âƒ£ Smallâ€‘distance chart (10â€¯km â†’ 1â€¯000â€¯000â€¯km) -->
  <canvas id="timeKm"    width="800" height="300"></canvas>

  <!-- 2ï¸âƒ£ AU lowâ€‘range chart (0â€¯â†’â€¯3â€¯AU) -->
  <canvas id="timeAUlow"  width="800" height="300"></canvas>

  <!-- 3ï¸âƒ£ AU highâ€‘range chart (2â€¯â†’â€¯60â€¯AU) -->
  <canvas id="timeAUhigh" width="800" height="300"></canvas>
</div>

<!-- ---------- Fuelâ€‘fraction charts (same order) ---------- -->
<div class="group">
  <!-- Second slider set â€“ will stay synced with the first -->
  <div class="controls">
    <div class="control">
      <label>Constant Acceleration (mÂ·sâ»Â²)</label>
      <input class="accel" type="range" min="0.1" max="50" step="0.1" value="9.80665">
      <output class="accelOut"></output>
      <div class="unit-note">1â€¯gâ€¯=â€¯9.80665â€¯mÂ·sâ»Â²</div>
    </div>
    <div class="control">
      <label>Engine Exhaust Velocity (mÂ·sâ»Â¹)</label>
      <input class="ve" type="range" min="1000000" max="80000000" step="500000" value="40000000">
      <output class="veOut"></output>
    </div>
  </div>

  <!-- 1ï¸âƒ£ Smallâ€‘distance fuel chart -->
  <canvas id="fuelKm"    width="800" height="300"></canvas>

  <!-- 2ï¸âƒ£ AU lowâ€‘range fuel chart -->
  <canvas id="fuelAUlow"  width="800" height="300"></canvas>

  <!-- 3ï¸âƒ£ AU highâ€‘range fuel chart -->
  <canvas id="fuelAUhigh" width="800" height="300"></canvas>
</div>

<script>
// ---------------------------------------------------
// Initialise synchronization of all sliders
// ---------------------------------------------------
syncSliders();

// ---------------------------------------------------
// Create the six charts (order matches the HTML)
// ---------------------------------------------------
charts.timeKm    = createTimeChart(document.getElementById('timeKm').getContext('2d'),
                                  'km','km',1_000_000,false);
charts.timeAUlow = createTimeChart(document.getElementById('timeAUlow').getContext('2d'),
                                  'AU','AU',3);
charts.timeAUhigh= createTimeChart(document.getElementById('timeAUhigh').getContext('2d'),
                                  'AU','AU',60);

charts.fuelKm    = createFuelChart(document.getElementById('fuelKm').getContext('2d'),
                                  'km','km',1_000_000,false);
charts.fuelAUlow = createFuelChart(document.getElementById('fuelAUlow').getContext('2d'),
                                  'AU','AU',3);
charts.fuelAUhigh= createFuelChart(document.getElementById('fuelAUhigh').getContext('2d'),
                                  'AU','AU',60);

// ---------------------------------------------------
// Populate all charts
// ---------------------------------------------------
function recompute(){
  const kmSeries  = generateKmSeries();          // 10â€¯km â†’ 1â€¯000â€¯000â€¯km
  const lowAU     = generateAUSeries(0.1,3);     // 0.1â€¯AU â†’ 3â€¯AU
  const highAU    = generateAUSeries(2,60);     // 2â€¯AU â†’ 60â€¯AU

  // Travelâ€‘time data
  charts.timeKm.data.datasets[0].data    = kmSeries.time;
  charts.timeAUlow.data.datasets[0].data = lowAU.time;
  charts.timeAUhigh.data.datasets[0].data= highAU.time;

  // Fuelâ€‘fraction data
  charts.fuelKm.data.datasets[0].data    = kmSeries.fuel;
  charts.fuelAUlow.data.datasets[0].data = lowAU.fuel;
  charts.fuelAUhigh.data.datasets[0].data= highAU.fuel;

  // Refresh every chart
  Object.values(charts).forEach(c=>c.update());
}

// Initial draw
recompute();
</script>
</body>
</html>